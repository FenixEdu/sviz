(function(e,t,n,r){var i={};e.SViz=i;var s=!0,o,u={fallbackLng:"en",lng:"pt",localesRelPath:"/locales/__lng__/__ns__.json",localesBasePath:"/js",getAsync:!1,debug:!0},a={info:function(e,t){console.log("[SViz Info] - "+e),typeof t!="undefined"&&console.log(t)},debug:function(e,t){o&&(console.log("[SViz Debug] - "+e),typeof t!="undefined"&&console.log(t))},error:function(e,t){console.log("[SViz Error] - "+e),typeof t!="undefined"&&console.log(t)}},f={valuesInsideDomainOnly:function(e){return function(t){if(t.grade>=e.minGrade&&t.grade<=e.maxGrade)return t.grade}},computeMinMaxAndQuartiles:function(e,t){var r=[];e.forEach(function(e){var n=e[t];r.push(n)});var i=r.sort(n.ascending),s=n.round(n.quantile(i,0),2),o=n.round(n.quantile(i,.25),2),u=n.round(n.quantile(i,.5),2),f=n.round(n.quantile(i,.75),2),l=n.round(n.quantile(i,1),2),c={min:s,q1:o,q2:u,q3:f,max:l,median:u};return a.debug("Computed Quantiles",c),c},binData:function(e,t){var r=n.layout.histogram().range([e.minGrade-.5,e.maxGrade+.5]).bins(e.maxGrade-e.minGrade+1).frequency(t).value(function(e){return e.grade})(e.grades),i=e.ranks?e.ranks.length:0,s=e.grades.length;if(i>0){var o=[],u,a,f=t?1:1/s;for(var l=0;l<i;l++)u=o[l]=[],u.x=e.minGrade-i+l-.5,u.dx=1,u.y=0,u.label=e.ranks[l];for(var l=0;l<s;l++){a=e.grades[l];for(var c=0;c<i;c++)if(a.grade===e.ranks[c]){u=o[c],u.y+=f,u.push(a);break}}r=o.concat(r)}return r.forEach(this.sortBinElements),r},truncate:function(e,t,n){return e.length>t&&(e=e.substring(0,t+1),e=e.substring(0,Math.min(e.length,e.lastIndexOf(" "))),e+=n),e},comparator:function(e,t){return e.grade>t.grade?1:e.grade<t.grade?-1:e.id>t.id?1:e.id<t.id?-1:0},sortBinElements:function(e,t,n){e.sort(this.comparator)}},l={};l.extend=function(e){var r={},i=typeof e.update=="function"?e.update:function(){a.info("No method to update this visualization was defined.")},s=function(e,t){typeof e=="object"?i.call(r,e,t):n.json(e,function(e){i.call(r,e,t)})};return t.extend(r,e),function(e,t,n){return r.initialize(e,t,n),r.render(),{update:s}}};var c=l.extend({initialize:function(e,t,n){this.data=e,this.selector=t,this.opts=n},render:function(){var e=this.data,t=this.selector,i=i;if(!i)var i={};var s=r.t("evaluation-statistics",{returnObjectTrees:!0});n.select(t).append("h4").text(s.title);var o=e.grades.length,u=n.sum(e.grades,function(t){return t.grade>=e.minRequiredGrade}),a=n.sum(e.grades,function(t){return t.grade===e.notAttended});i.total!==undefined&&n.select(t).append("p").text(s["total-students"]+o),i.approved!==undefined&&n.select(t).append("p").text(s.approved+n.round(u*100/o,1)+"%  ("+u+" "+r.t("students")+")"),e.notAttended&&i.noattend!=0&&n.select(t).append("p").text(s["no-attends"]+n.round(a*100/o,1)+"%  ("+a+" "+r.t("students")+")"),i.mean!==undefined&&n.select(t).append("p").text(s.mean+n.round(n.mean(e.grades,f.valuesInsideDomainOnly(e)),2)),i.extent!==undefined&&n.select(t).append("p").text(s.extent+n.extent(e.grades,f.valuesInsideDomainOnly(e))),i.median!==undefined&&n.select(t).append("p").text(s.median+n.round(n.median(e.grades,f.valuesInsideDomainOnly(e)),2))}}),h=l.extend({initialize:function(e,t,n){this.data=e,this.selector=t,this.opts=n},render:function(){var e=this.data,i=this.selector,s=this.opts;if(!s)var s={};if(s.barWidth===undefined)s.barWidth=.9;else if(s.barWidth>1||s.barWidth<=0)s.barWidth=.9,a.info("[Histogram] Option barWidth has an impossible value. It must be between ]0;1]. Setting to default value of "+s.barWidth+".");s.barNumbers===undefined&&(s.barNumbers="count"),s.tipNumbers===undefined&&(s.tipNumbers="percent");var o=function(t,n){if(n==="count")return s.barNumbers==="count"?t:t*e.grades.length/100;if(n==="percent")return s.barNumbers==="count"?t*100/e.grades.length:t},u=function(t){return t*e.grades.length},l=function(t){return t/e.grades.length},c=function(e,t){return n.round(e*100,t)},h=r.t("histogram",{returnObjectTrees:!0}),p={top:10,right:10,bottom:20,left:30},d=60,v=570-p.left-d/2,m=240-d/2-p.right,g=260-p.top-p.bottom,y=n.select(i).append("svg").attr("width",v+m+d+p.left+p.right).attr("height",g+p.top+p.bottom+(s.legend==="top"?20:0)),b=y.append("g").attr("transform","translate("+p.left+","+(p.top+(s.legend==="top"?20:0))+")"),w=n.scale.linear(),E=n.scale.ordinal();e.ranks&&E.domain(e.ranks);var S=n.scale.linear().rangeRound([g,0]),x,T,N,C,k=function(e){x=e.ranks?e.ranks.length:0,T=e.maxGrade-e.minGrade+1+x,N=Math.floor(v/T),C=N*s.barWidth;var t=v-N*T;w.domain([e.minGrade-.5,e.maxGrade+.5]).rangeRound([x*N,v-t]),E.rangeRoundBands([0,x*N],1-s.barWidth)};k(e);var L=f.binData(e,s.barNumbers!=="percent");S.domain([0,n.max(L,function(e){return e.y})]),e.minRequiredGrade&&s.showMinGrade!=0&&b.append("g").append("rect").attr("class","minRect").attr("x",0).attr("width",w(e.minRequiredGrade)).attr("height",g);var A=function(e){return function(t){if(e.student.id&&s.highlightStudent!=0)for(var n in t)if(!(n in{x:1,dx:1,y:1,label:1})&&t[n].id==e.student.id)return"tip bar you";return"tip bar"}},O=function(e){if(s.tooltip!=0){if(s.tipNumbers==="count")return s.barNumbers==="percent"?n.round(u(e)*100):e;if(s.tipNumbers==="percent")return s.barNumbers==="percent"?c(e,2)+"%":n.round(l(e),2)+"%"}},M=b.selectAll(".bar").data(L).enter().append("g").attr("class",A(e)).attr("title",function(e){return O(e.y)}).attr("transform",function(e){return"translate("+w(e.x+.5)+","+S(e.y)+")"}).on("mouseover",function(e){s.details!=0&&(V.remove(),K(e,J.range([e.x,e.x+1])(e))),s.table!=0&&(tt.remove(),nt(e))});M.append("rect").attr("x",-C/2).attr("width",C).attr("height",function(e){return g-S(e.y)}),s.barNumbers!="none"&&M.append("text").attr("dy",".75em").attr("y",6).attr("x",0).attr("text-anchor","middle").text(function(e){if(e.y!=0)return s.barNumbers=="percent"?c(e.y,0)+"%":e.y}),s.tooltip!=0&&s.tipNumbers!="none"&&t(".tip").qtip({style:"qtip-tipsy",position:{my:"bottom middle",at:"top middle"}}),e.minRequiredGrade&&s.showMinGrade!=0&&b.append("g").attr("id","minGradeLine").attr("class","line").attr("transform",function(t){return"translate("+w(e.minRequiredGrade)+", 0)"}).append("line").attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",g);if(s.showMean!=0){var _=n.round(n.mean(e.grades,f.valuesInsideDomainOnly(e)),2);b.append("g").attr("class","mean").attr("transform",function(e){return"translate("+w(_)+", 0)"}).append("line").attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",g)}if(s.xAxis!=0){var D=n.svg.axis().scale(w).tickValues(n.range(e.minGrade,e.maxGrade+1)).orient("bottom").tickFormat(n.format("d")).outerTickSize(0),P=b.append("g").attr("class","x axis").attr("transform","translate(0,"+g+")").call(D);s.xAxisLabel!=0&&P.append("text").attr("class","label").attr("x",v).attr("y",-6).text("Grade");var H=n.svg.axis().scale(E).orient("bottom").outerTickSize(0);b.append("g").attr("class","xr axis").attr("transform","translate(0,"+g+")").call(H)}if(s.yAxis!=0){var B=n.svg.axis().scale(S).orient("left").tickFormat(function(e){return s.barNumbers==="percent"?c(e,0):e}),P=b.append("g").attr("class","y axis").call(B);s.yAxisLabel!=0&&(s.barNumbers==="percent"?P.append("text").attr("class","label").attr("x",15).attr("dy",".71em").text("%"):P.append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").text(h["y-label"]))}if(s.legend!=="none"&&s.legend!=="arrows"){var j=b.append("g").attr("class","legend");if(s.legend==="side"){j.attr("transform","translate("+(v-18)+",0)");var F=0;if(e.minRequiredGrade&&s.showMinGrade!=0){var I=j.append("g").attr("transform","translate(0,"+F+")");I.append("line").attr("x2",18).attr("y1",9).attr("y2",9).attr("class","line"),I.append("text").attr("x",-6).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(h["min-grade"]),F+=20}if(s.showMean!=0){var I=j.append("g").attr("transform","translate(0,"+F+")");I.append("line").attr("x2",18).attr("y1",9).attr("y2",9).attr("class","mean"),I.append("text").attr("x",-6).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(h.mean),F+=20}if(e.student.id&&s.highlightStudent!=0){var I=j.append("g").attr("transform","translate(0,"+F+")");I.append("rect").attr("width",18).attr("height",18).style("fill","purple"),I.append("text").attr("x",-6).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(h["self-id"])}}else if(s.legend==="top"){j.attr("transform","translate(500,-25)");var q=0;if(e.minRequiredGrade&&s.showMinGrade!=0){var I=j.append("g").attr("transform","translate(0,"+q+")");I.append("line").attr("x2",18).attr("y1",9).attr("y2",9).attr("class","line"),I.append("text").attr("x",26).attr("y",9).attr("dy",".35em").text(h["min-grade"]),q+=26+I.select("text")[0][0].getBBox().width+20}if(s.showMean!=0){var I=j.append("g").attr("transform","translate("+q+",0)");I.append("line").attr("x2",18).attr("y1",9).attr("y2",9).attr("class","mean"),I.append("text").attr("x",26).attr("y",9).attr("dy",".35em").text(h.mean),q+=26+I.select("text")[0][0].getBBox().width+20}if(e.student.id&&s.highlightStudent!=0){var I=j.append("g").attr("transform","translate("+q+",0)");I.append("rect").attr("width",18).attr("height",18).style("fill","purple"),I.append("text").attr("x",26).attr("y",9).attr("dy",".35em").text(h["self-id"])}}}s.legend==="arrows"&&(e.minRequiredGrade&&s.showMinGrade!=0&&n.select("#minGradeLine").append("g").attr("transform","translate(10,10)").append("text").attr("x",-6).attr("y",9).attr("dy",".35em").text(h["min-grade"]),s.showMean!=0&&n.select(".mean").append("g").attr("transform","translate(10,30)").append("text").attr("x",-6).attr("y",9).attr("dy",".35em").text(h.mean),e.student.id&&s.highlightStudent!=0&&n.select(".you").append("g").attr("transform","translate(0,-30)").append("text").attr("x",-6).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(h["self-id"]));if(s.details!=0){var R=y.append("g").attr("transform","translate("+(p.left+v+d)+","+(p.top+(s.legend==="top"?20:0))+")"),U=n.scale.linear().domain([]).rangeRound([0,m]),z=m/10/2;s.detailsBarWidth&&(s.detailsBarWidth>=3&&s.detailsBarWidth<=m/10?z=s.detailsBarWidth:a.info("[Histogram] Option detailsBarWidth has an impossible value. It must be between 3 and "+m/10+". Setting to default value of "+z+"."));var W=n.svg.axis().scale(U).ticks(10).orient("bottom");R.append("g").attr("class","x2 axis").attr("transform","translate(0,"+g+")").call(W);var X=R.append("foreignObject").attr("width",m).attr("height",g).attr("class","temporary").attr("y",g/2-28),V=X.append("xhtml:div").style("text-align","center").html(h["hover-text"]),J=n.layout.histogram().range([e.minGrade,e.maxGrade]).bins(10).frequency(s.barNumbers!=="percent").value(function(e){return e.grade});function K(t,r){U.domain([t.x,t.x+1]),W.tickFormat(function(n){if((n===t.x||n===t.x+.5||n===t.x+.9)&&n>=e.minGrade&&n<=e.maxGrade)return n});var i=t.x>=e.minGrade?t.x:e.minGrade,s=t.x+1>=e.maxGrade?e.maxGrade+.1:t.x+1.1;W.tickValues(n.range(i,s,.1)),R.select(".x2").call(W);var o=R.selectAll(".bar").data(r);o.enter().append("g").attr("transform",function(e){return"translate("+U(e.x)+",0)"}).append("rect").attr("x",1-z/2).attr("width",z-2),o.attr("class",A(e)),o.select("rect").attr("y",function(e){return S(e.y)}).attr("height",function(e){return g-S(e.y)}),o.exit().remove()}function Q(){U.domain([]),R.select(".x.axis").call(W),R.selectAll(".bar").remove(),X.append("xhtml:div").append(function(){return V.remove()[0][0]})}}if(s.table!=0){var G=n.select(i).append("table").attr("class","table table-hover table-bordered table-condensed"),Y=s.tableColumns||["ID","photo","name","grade"],Z=G.append("thead");Z.append("tr").selectAll("th").data(function(){return Y.map(function(e){return{column:e,value:h["table-columns"][e]}})}).enter().append("th").text(function(e){return e.value});var et=G.append("tbody"),tt=et.append("tr").append("td").attr("colspan",Y.length).attr("class","temporary").style("text-align","center").text(h["hover-text"]);function nt(e){var t=et.selectAll("tr").data(e);t.enter().append("tr"),t.selectAll("td").data(function(e){return Y.map(function(t){return{column:t,value:e[t]}})}).enter().append("td"),t.selectAll("td").html(function(e){return e.column=="photo"?"<img src='"+e.value+"' width='25px' alt='photo'/>":e.value}),t.exit().remove()}function rt(){et.selectAll("tr").remove(),et.append("tr").append(function(){return tt.remove()[0][0]})}}this.myUpdate=function(r){this.data=r,k(r),L=f.binData(r,s.barNumbers!=="percent"),D.tickValues(n.range(r.minGrade,r.maxGrade+1)),E.domain(r.ranks?r.ranks:[]),H.scale(E),S.domain([0,n.max(L,function(e){return e.y})]);var i=750,o=25,u=function(e,t){return t*o},a=b.transition().duration(i+o*T);a.select(".x").call(D),a.select(".xr").call(H),a.select(".y").call(B),t(".tip").attr("oldtitle",null);var l=b.selectAll(".bar").data(L),h=l.enter().append("g").attr("class",A(r)).on("mouseover",function(e){s.details!=0&&(V.remove(),K(e,J.range([e.x,e.x+1])(e))),s.table!=0&&(tt.remove(),nt(e))});h.append("rect"),s.barNumbers!="none"&&h.append("text").attr("dy",".75em").attr("y",6).attr("x",0).attr("text-anchor","middle"),l.transition().delay(u).duration(i).attr("class",A(r)).attr("transform",function(e){return"translate("+w(e.x+.5)+","+S(e.y)+")"}),l.attr("title",function(e){return O(e.y)}),l.select("rect").attr("x",1-C/2).attr("width",C-2).attr("height",function(e){return g-S(e.y)}),l.select("text").text(function(e){if(e.y!=0)return s.barNumbers=="percent"?c(e.y,0)+"%":e.y}),l.exit().remove(),s.tooltip!=0&&s.tipNumbers!="none"&&t(".tip").qtip({style:"qtip-tipsy",position:{my:"bottom middle",at:"top middle"}}),e.minRequiredGrade&&s.showMinGrade!=0&&(a.select(".minRect").attr("width",w(r.minRequiredGrade)),a.select(".line").attr("transform",function(e){return"translate("+w(r.minRequiredGrade)+", 0)"}));if(s.showMean!=0){var p=n.round(n.mean(r.grades,f.valuesInsideDomainOnly(r)),2);a.select(".mean").attr("transform",function(e){return"translate("+w(p)+", 0)"})}s.details!=0&&Q(),s.table!=0&&rt(),t(".tip").qtip({style:"qtip-tipsy",position:{my:"bottom middle",at:"top middle"}})}},update:function(e,t){this.myUpdate(e)}}),p=l.extend({initialize:function(e,t,n){this.data=e,this.selector=t,this.opts=n},render:function(){var e=this.data,i=this.selector,s=this.opts,o=r.t("donuts",{returnObjectTrees:!0});a.debug("Invoked Multiple Donuts Visualization with opts",s);var u=.75,f=60,l=40,c=s?s.radius||f:f,h=s?s.innerRadius||l:l,p=s?s.width||t(i).width():t(i).width(),d=s?s.height||p*u:p*u,v=s?s.showLegend===!0:!0,m=s?s.legendSelector||i:i,g=n.svg.arc().outerRadius(c).innerRadius(h),y=n.layout.pie().sort(null).value(function(e){return e.population});e.entries.forEach(function(r){var i=0;t.each(e.domain,function(e,t){i+=+r[t]}),r.total=i,r.values=e.domain.map(function(e){var t=n.round(+r[e]/+r.total*100,1)+"%";return{name:e,population:+r[e],total:i,perc:t}})});if(v){var b=n.select(m).append("svg").attr("class","legend-text").attr("width",150).attr("height",c*2).selectAll("g").data(e.domain.slice().reverse()).enter().append("g").attr("transform",function(e,t){return"translate(0,"+t*20+")"});b.append("rect").attr("width",12).attr("height",12).attr("class",function(e){return"donut-"+e}),b.append("text").attr("x",16).attr("y",6).attr("dy",".35em").text(function(e){return o[e]})}var w=n.select(i).selectAll(".donut").data(e.entries).enter().append("svg").attr("class","donut").attr("width",c*2).attr("height",c*2).append("g").attr("transform","translate("+c+","+c+")");w.selectAll(".donut-arc").data(function(e){return y(e.values)}).enter().append("path").attr("title",function(e){return"<center>"+o[e.data.name]+"<br>"+e.data.perc+"<br/>"+e.data.population+"/"+e.data.total+"</center>"}).attr("class",function(e){return"tip donut-arc donut-"+e.data.name}).attr("d",g),w.append("text").attr("dy",".35em").attr("class","donut-center-text tip").attr("title",function(e){return e.description}).style("text-anchor","middle").text(function(e){return e.text}),t(".tip").qtip({style:"qtip-tipsy",position:{target:"mouse",adjust:{x:15,y:15}}})}}),d=l.extend({initialize:function(e,t,n){this.data=e,this.selector=t,this.opts=n},render:function(){var e=this.data,t=this.selector,r=this.opts,i=f.computeMinMaxAndQuartiles(e.grades,"grade"),s=.75,o=20,u=o*5,a=300,l=r?r.width||u:u,c=r?r.height||a:a,h=r?r.boxWidth||o:o,p=n.select(t).append("svg").attr("width",l).attr("height",c);p.append("line").attr("class","boxplot-line").attr("x1",l/2).attr("x2",l/2).attr("y1",0).attr("y2",c);var d=function(e,t,n){return c-c*e/(n-t)},v=function(e,t){e.append("line").attr("class","boxplot-quantile-line").attr("x1",l/2-h/2).attr("x2",l/2+h/2).attr("y1",t).attr("y2",t)},m=function(e,t,n,r){e.append("text").attr("class","boxplot-quantile-text "+r).attr("x",0).attr("y",n).text(t)},g=d(i.q1,i.min,i.max),y=d(i.q2,i.min,i.max),b=d(i.q3,i.min,i.max);p.append("rect").attr("stroke","black").attr("fill","white").attr("x",l/2-h/2).attr("y",b).attr("width",h).attr("height",g-b),v(p,0),v(p,y),v(p,c),m(p,i.max,10,"boxplot-max-text"),m(p,i.q3,b+5,"boxplot-q3-text"),m(p,i.q2,y+5,"boxplot-q2-text"),m(p,i.q1,g+5,"boxplot-q1-text"),m(p,i.min,c,"boxplot-min-text")}}),v=l.extend({initialize:function(e,t,n){this.data=e,this.selector=t,this.opts=n},render:function(){var e=this.data,i=this.selector,s=this.opts,o=300,u=250,a=s?s.width||o:o,f=s?s.height||u:u,l=Math.min(a,f)/2,c=e.grades.length,h=r.t("sunburst",{returnObjectTrees:!0}),p=function(e,t,n){t&&(e.studentGrade=!0,e.studentGradeValue=n)},d=function(e,r){var i=!1,s={name:"root",children:[]},o={name:"approved",children:[]},u={name:"flunked",children:[]},a={name:"not-evaluated",children:[]},f={name:"10-14",children:[]},l={name:"15-20",children:[]},c={name:"0-4",children:[]},h={name:"5-9",children:[]};return t.each(e,function(e,t){var s=t.grade,o=t.id===r;s==="NE"?(a.children.push(t),p(a,o,s)):s==="RE"||n.round(s,0)<10?s==="RE"?(i=!0,u.children.push(t),p(u,o,s)):n.round(s,0)<=4?(p(c,o,s),c.children.push(t)):(p(h,o,s),h.children.push(t)):n.round(s,0)<=14?(p(f,o,s),f.children.push(t)):(p(l,o,s),l.children.push(t))}),f.size=f.children.length,l.size=l.children.length,c.size=c.children.length,h.size=h.children.length,f.data=f.children,f.data=l.children,c.data=c.children,h.data=h.children,f.children=undefined,l.children=undefined,c.children=undefined,h.children=undefined,o.children.push(l),o.children.push(f),o.size=f.size+l.size,i?(u.size=u.children.length,u.children=undefined):(u.children.push(h),u.children.push(c),u.size=c.size+h.size),a.size=a.children.length,a.children=undefined,s.children.push(o),s.children.push(u),s.children.push(a),s},v=n.select(i).append("svg").attr("width",a).attr("height",f).append("g").attr("id","container").attr("transform","translate("+a/2+","+f/2+")"),m=n.layout.partition().size([2*Math.PI,l*l]).value(function(e){return e.size}),g=n.svg.arc().startAngle(function(e){return e.x}).endAngle(function(e){return e.x+e.dx}).innerRadius(function(e){return Math.sqrt(e.y)}).outerRadius(function(e){return Math.sqrt(e.y+e.dy)}),y=n.svg.arc().startAngle(function(e){return e.x+5}).endAngle(function(e){return e.x+e.dx+5}).innerRadius(function(e){return Math.sqrt(e.y)}).outerRadius(function(e){return Math.sqrt(e.y+e.dy)});v.append("circle").attr("r",l).style("opacity",0);var b=undefined,w=undefined,E=d(e.grades,e.student.id),S=m.nodes(E),x=v.data([E]).selectAll("path").data(S).enter().append("path").attr("display",function(e){return e.depth?null:"none"}).attr("d",g).attr("title",function(e){return"<center>"+h[e.name]+"<br>"+e.size+" "+h.of+" "+c+" "+h.students+"</center>"}).attr("class",function(e){var t="sunburst-path tip sunburst-path-"+e.name;return e.studentGrade&&(b=e,t+=" sunburst-own-grade"),t}).attr("fill-rule","evenodd").style("opacity",function(e){return e.studentGrade?1:.3}).on("mouseover",function(e){t(".sunburst-path").attr("style","opacity: 0.3"),t(this).attr("style","opacity: 1"),t(".sunburst-percentage",i).text(n.round(e.value/c*100,1)+"%"),t(".sunburst-percentage",i).attr("y",0),t(".sunburst-text",i).text(h[e.name])}).on("mouseout",function(e){t(this).attr("style","opacity: 0.3"),t(".sunburst-own-grade").attr("style","opacity: 1");if(b)var n=b.studentGradeValue!=="RE"&&b.studentGradeValue!=="NE"?b.studentGradeValue:h[b.name];else var n=h["no-eval"];t(".sunburst-percentage",i).text(n),t(".sunburst-percentage",i).attr("y",10),t(".sunburst-text",i).text("")});v.append("text").attr("class","sunburst-percentage").attr("text-anchor","middle"),v.append("text").attr("y",20).attr("class","sunburst-text").attr("text-anchor","middle");if(b)var T=b.studentGradeValue!=="RE"&&b.studentGradeValue!=="NE"?b.studentGradeValue:h[b.name];else var T=h["no-eval"];t(".sunburst-percentage",i).text(T),t(".sunburst-percentage",i).attr("y",10),t(".sunburst-text",i).text(""),t(".tip").qtip({style:"qtip-tipsy",position:{target:"mouse",adjust:{x:10,y:10}}})},update:function(e,n){this.data=e,t(this.selector).empty(),this.render()}}),m=l.extend({initialize:function(e,t,n){this.data=e,this.selector=t,this.opts=n},render:function(){var e=this.data,i=this.selector,s=this.opts,o=r.t("progress-bars",{returnObjectTrees:!0}),u=600,a=e.length*50,f=s?s.width||u:u,l=s?s.height||a:a,c=n.select(i).append("svg").attr("width",f).attr("height",l),h=function(e,t,r,i,s,u,a,l,c,h){var p=e.append("g").attr("transform","translate("+t+","+r+")").attr("y",r).attr("class","tip").attr("title",function(e){var t=i>s?100:n.round(i/s*100,1);return"<center>"+l+"<br>("+t+"%) "+i+" "+o["ects-of"]+" "+s+" "+o["required-ects"]+"</center>"});return p.append("rect").attr("x",0).attr("y",0).attr("width",f-t).attr("height",a).attr("class","progress-bar progress-outer-bar "+h),p.append("rect").attr("x",0).attr("y",(a-u)/2).attr("width",i/s*(f-t)).attr("height",u).attr("class",function(){return"progress-bar progress-inner-bar "+c+(i>=s?"-completed":"-incomplete")}),p.append("text").attr("x",-t).attr("y",a/2+5).style("cursor","pointer").text(l),p};e.sort(function(e,t){return e.year-t.year}),t.each(e,function(e,t){h(c,100,(e+1)*25+20,t.credits,t["required-credits"],10,20,t.degree,"progress-main","progress-main")}),t(".tip").qtip({style:"qtip-tipsy",position:{target:"mouse",adjust:{x:10,y:10}}})}}),g=l.extend({initialize:function(e,t,n){this.data=e,this.selector=t,this.opts=n},render:function(){var e=this.data,i=this.selector,s=this.opts;if(!s)var s={};s.margin===undefined?s.margin={top:10,right:10,bottom:20,left:30}:(s.margin.top===undefined&&(s.margin.top=10),s.margin.bottom===undefined&&(s.margin.bottom=20),s.margin.left===undefined&&(s.margin.left=30),s.margin.right===undefined&&(s.margin.right=10)),s.width===undefined?s.width=600:s.width<=300&&a.info("[Approval Rate] Option width has a small value. The recommended value is "+s.width+" or greater.");if(s.barWidth===undefined)s.barWidth=.9;else if(s.barWidth>1||s.barWidth<=0)s.barWidth=.9,a.info("[Approval Rate] Option barWidth has an impossible value. It must be between ]0;1]. Setting to default value of "+s.barWidth+".");s.blockWidth===undefined?s.blockWidth=50:s.blockWidth<=5&&(s.blockWidth=50,a.info("[Approval Rate] Option blockWidth has an impossible value. It must be above 5. Setting to default value of "+s.blockWidth+"px.")),s.blockPadding===undefined?s.blockPadding=8:s.blockPadding<=0&&(s.blockPadding=8,a.info("[Approval Rate] Option blockPadding has a negative value. Setting to default value of "+s.blockPadding+"px.")),s.labelSize===undefined&&(s.labelSize=150),s.titleclass===undefined&&(s.titleclass="h4");var o=r.t("approval-rate",{returnObjectTrees:!0}),u=s.width-s.margin.left-s.margin.right,f=70+e.periods.length*s.blockWidth+(s.legend!=0?28:5),l=n.select(i).append("svg").attr("width",u+s.margin.left+s.margin.right).attr("height",f+s.margin.top+s.margin.bottom),c=l.append("g").attr("transform","translate("+s.margin.left+","+s.margin.top+")");s.classic==1&&c.append("rect").attr("class","bg").attr("width",u).attr("height",f);var h=c.append("g").attr("transform","translate("+s.labelSize+","+70+")"),p=u-5-s.labelSize,d=e.periods.length*s.blockWidth;s.classic==1&&h.append("rect").attr("class","chart").attr("width",p).attr("height",d),c.append("text").attr("class",s.titleclass).attr("x",u/2).attr("text-anchor","middle").attr("dy",20).text(o.title);var v=n.scale.ordinal().rangeRoundBands([0,d]),m=n.scale.linear().rangeRound([0,p]),g,y,b=function(e){g=Math.floor((s.blockWidth-s.blockPadding*2)/2),y=g*s.barWidth,v.domain(e.map(function(e){return e[0]})),m.domain([0,n.max(e,function(e){return e[1]})])};b(e.periods);var w=(1-s.barWidth)*g,E=h.selectAll(".block").data(e.periods).enter().append("g").attr("class","block").attr("transform",function(e){return"translate(0,"+v(e[0])+")"});E.append("rect").attr("class",(s.classic==1?"enroled-classic":"enroled")+" tip").attr("title",function(e){return e[1]}).attr("y",s.blockPadding+w).attr("height",y).attr("width",function(e){return m(e[1])}),E.append("rect").attr("class",(s.classic==1?"approved-classic":"approved")+" tip").attr("title",function(e){return e[2]}).attr("y",s.blockPadding+g+w).attr("height",y).attr("width",function(e){return m(e[2])}),s.tooltip!=0&&t(".tip").qtip({style:"qtip-tipsy",position:{adjust:{x:0,y:0},target:"mouse",my:"bottom left"}});if(s.xAxis!=0){var S=n.svg.axis().scale(v).orient("left").outerTickSize(0);h.append("g").attr("class","x axis").call(S)}if(s.yAxis!=0){var x=n.svg.axis().scale(m).tickValues(n.range(0,n.max(e.periods,function(e){return e[1]})+1)).tickFormat(n.format("d")).orient("top"),T=h.append("g").attr("class","y axis").call(x);s.yAxisLabel!=0&&T.append("text").attr("class","label").attr("x",p).attr("y","-25").text(o["axis-label"])}if(s.legend!=0){var N=18,C=c.append("g").attr("class","legend"),k=C.append("g");k.append("rect").attr("width",N).attr("height",N).attr("class",s.classic==1?"enroled-classic":"enroled"),k.append("text").attr("x",N+8).attr("y",9).attr("dy",".35em").text(o["legend-enroled"]),k=C.append("g").attr("transform","translate("+(N+8+k.select("text")[0][0].getBBox().width+20)+",0)"),k.append("rect").attr("width",N).attr("height",N).attr("class",s.classic==1?"approved-classic":"approved"),k.append("text").attr("x",N+8).attr("y",9).attr("dy",".35em").text(o["legend-approved"]);var L=C[0][0].getBBox().width;C.attr("transform","translate("+(s.classic==1?(u-L)/2:u-L)+","+(70+e.periods.length*s.blockWidth+5)+")")}},update:function(e,t){}}),y=l.extend({initialize:function(e,t,n){this.data=e,this.selector=t,this.opts=n},render:function(){function T(e){}function N(e){var t=n.select(this).node().parentNode;n.select(t).selectAll("circle").style("display","none"),n.select(t).selectAll("text.value").style("display","block")}function C(e){var t=n.select(this).node().parentNode;n.select(t).selectAll("circle").style("display","block"),n.select(t).selectAll("text.value").style("display","none")}var e=this.data,i=this.selector,s=this.opts,o=r.t("bubbles",{returnObjectTrees:!0}),u={top:20,right:400,bottom:0,left:20},a=600,l=e.entries.length*20+15,c=e["start-year"],h=e["end-year"],p=n.scale.category20c(),d=n.scale.linear().range([0,a]),v=n.svg.axis().scale(d).orient("top"),m=n.format("dddd");v.tickFormat(m).tickValues(n.range(c,h+1));var g=n.select(i).append("svg").attr("width",a+u.left+u.right).attr("height",l+u.top+u.bottom).append("g").attr("transform","translate("+u.left+","+u.top+")");d.domain([c,h]);var y=n.scale.linear().domain([c,h]).range([0,a]);g.append("g").attr("class","x axis").attr("transform","translate(0,0)").call(v);for(var b=0;b<e.entries.length;b++){var w=g.append("g").attr("class","bubble"),E=w.selectAll("circle").data(e.entries[b].years).enter().append("circle"),S=w.selectAll("text").data(e.entries[b].years).enter().append("text"),x=n.scale.linear().domain([0,n.max(e.entries[b].years,function(e){return e[1]/(e[1]+e[2]+e[3])*100})]).range([3,9]);E.attr("cx",function(e,t){return y(e[0])}).attr("cy",b*20+20).attr("r",function(e){return x(e[1]/(e[1]+e[2]+e[3])*100)}).attr("class","tip").attr("title",function(e){var t=n.round(e[1]/(e[1]+e[2]+e[3])*100,0);return"<center>"+t+"%<br>"+o.approved+"</center>"}).style("cursor","pointer").style("fill",function(e){return p(b)}).on("mouseover",T(e.entries[b])),S.attr("y",b*20+25).attr("x",function(e,t){return y(e[0])-5}).attr("class","value").text(function(e){var t=n.round(e[1]/(e[1]+e[2]+e[3])*100,0);return t}).style("fill",function(e){return p(b)}).style("display","none"),w.append("text").attr("y",b*20+25).attr("x",a+20).attr("class","bubbles-label").text(f.truncate(e.entries[b].name,50,"...")).style("fill",function(e){return p(b)}).style("cursor","pointer").on("mouseover",N).on("mouseout",C)}t(".tip").qtip({style:"qtip-tipsy",position:{target:"mouse",adjust:{x:10,y:10}}})}}),b=l.extend({initialize:function(e,t,n){this.data=e,this.selector=t,this.opts=n},render:function(){var e=this.data,t=this.selector,i=this.opts;if(!i)var i={};var s=r.t("overall-statistics",{returnObjectTrees:!0});n.select(t).append("h4").text(s.title),i.mean!=0&&n.select(t).append("p").text(s.mean+e.mean),i.extent!=0&&n.select(t).append("p").text(s.extent+e.minGrade+" , "+e.maxGrade),i.approved!=0&&n.select(t).append("p").text(s.approved+e.approved),i.flunked!=0&&n.select(t).append("p").text(s.flunked+e.flunked),i.noattend!=0&&n.select(t).append("p").text(s["no-attends"]+e.notAttended)}}),w={showEvaluationStatistics:function(e,t,n){return c(e,t,n)},showHistogram:function(e,t,n){return h(e,t,n)},showCourses:function(e,t,n){return p(e,t,n)},showCourseOvertime:function(e,t,n){return p(e,t,n)},showEvaluationBoxPlot:function(e,t,n){return d(e,t,n)},showEvaluationSunburst:function(e,t,n){return v(e,t,n)},showStudentProgress:function(e,t,n){return m(e,t,n)},showApprovalRate:function(e,t,n){return g(e,t,n)},showOverallStatistics:function(e,t,n){return b(e,t,n)},showCurricularCoursesOvertime:function(e,t,n){return y(e,t,n)}};i.init=function(e){e&&(e.lang&&(u.lng=e.lang),e.localesBasePath&&(u.localesBasePath=e.localesBasePath),e.debug&&(o=e.debug)),E()};var E=function(){u.resGetPath=u.localesBasePath+u.localesRelPath,r.init(u,function(){a.debug("i18n initialized")}),s=!1};i.loadViz=function(e,t,r,i){a.debug("Loading vizualization",{vizName:e,data:t,selector:r,opts:i}),s&&(a.debug("SViz is not initialized. Initializing..."),E());if(w[e]!=="undefined"){if(typeof t=="object")return w[e](t,r,i);n.json(t,function(t){return w[e](t,r,i)})}else a.error("Visualization named '"+e+"' not found.")}})(this,jQuery,d3,i18n);